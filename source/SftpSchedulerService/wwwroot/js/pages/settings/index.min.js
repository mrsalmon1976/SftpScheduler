createApp({data(){return{isLoading:!0,isSmtpTabSelected:!1,settings:new SettingsModel,testEmailToAddress:"",testEmailSubject:"SftpScheduler Test Email",testEmailBody:"This is a test email from SftpScheduler."}},methods:{async loadSettings(){let n=await axios.get("/api/settings").catch(n=>{UiHelpers.showErrorToast("Error","",n.message),this.isLoading=!1});this.settings.digestDays=n.data.digestDays;this.settings.digestTime=n.data.digestTime;this.settings.maxConcurrentJobs=n.data.maxConcurrentJobs;this.settings.smtpHost=n.data.smtpHost;this.settings.smtpPort=n.data.smtpPort;this.settings.smtpUserName=n.data.smtpUserName;this.settings.smtpFromName=n.data.smtpFromName;this.settings.smtpFromEmail=n.data.smtpFromEmail;this.settings.smtpEnableSsl=n.data.smtpEnableSsl;this.isLoading=!1},openTestEmailDialog(){$("#modal-test-email").modal()},async sendTestEmail(){var n={host:this.settings.smtpHost,port:this.settings.smtpPort,userName:this.settings.smtpUserName,password:this.settings.smtpPassword,fromAddress:this.settings.smtpFromEmail,enableSsl:this.settings.smtpEnableSsl,toAddress:this.testEmailToAddress,subject:this.testEmailSubject,body:this.testEmailBody};await axios.post("/api/settings/email-test",n).then(()=>{UiHelpers.showSuccessToast("Test email successfully sent")}).catch(n=>{var i,t;if(n.response&&n.response.data&&n.response.data.errorMessages)for(i=n.response.data.errorMessages,t=0;t<i.length;t++)UiHelpers.showErrorToast("Validation Error","",i[t]);else UiHelpers.showErrorToast("Unexpected Error","",n.message)})},setLogReloadInterval(){var n=this;setInterval(function(){n.loadLogs()},6e4)},async submit(){if(this.isLoading=!0,$("#toastsContainerTopRight > .toast").remove(),!this.settings.validate()){this.isLoading=!1;UiHelpers.showErrorToast("Validation Failure","","Settings missing or invalid.",1e4);return}await axios.post("/api/settings",this.settings).then(()=>{UiHelpers.showSuccessToast("Global settings successfully updated")}).catch(n=>{var i,t;if(n.response&&n.response.data&&n.response.data.errorMessages)for(i=n.response.data.errorMessages,t=0;t<i.length;t++)UiHelpers.showErrorToast("Validation Error","",i[t]);else UiHelpers.showErrorToast("Validation Error","",n.message)});this.isLoading=!1}},mounted:function(){this.isLoading=!0;UiHelpers.setPageHeader("Global Settings");this.loadSettings();var n=this;$(document).on("shown.bs.tab",function(t){n.isSmtpTabSelected=t.target.innerText=="SMTP"})}}).mount("#app-settings");