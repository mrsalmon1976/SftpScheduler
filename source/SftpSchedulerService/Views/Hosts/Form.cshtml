@{
    Layout = "_Layout";
    ViewBag.PageTitle = "Hosts - Create New Host";
   
}
@section Scripts {
    <environment-script src="~/js/models/host.js"></environment-script>
    <environment-script src="~/js/pages/host/form.js"></environment-script>
}
<div id="app-host">
    <form class="form-horizontal">
        <div class="card card-info">
        <!-- form start -->
            <div class="card-header">
                <h3 class="card-title">Host Details</h3>
            </div>
            <div class="card-body">
                <div class="form-group row">
                    <label for="host-name" class="col-sm-2 col-form-label">Name</label>
                    <div class="col-sm-4">
                        <input type="text" v-model="host.name" @@blur="host.validateName()" class="form-control" id="host-name" placeholder="Name">
                        <span v-if="!host.isNameValid" class="error invalid-feedback">Please provide a name at least 5 characters long</span>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="host-host" class="col-sm-2 col-form-label">Host</label>
                    <div class="col-sm-4">
                        <input type="text" v-model="host.host" @@blur="host.validateHost()" class="form-control" id="host-host" placeholder="sftp.yourhost.com or 192.168.0.1">
                        <span v-if="!host.isHostValid" class="error invalid-feedback">Please provide a valid host</span>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="host-port" class="col-sm-2 col-form-label">Port</label>
                    <div class="col-sm-4">
                        <input type="number" v-model="host.port" class="form-control" id="host-port" placeholder="22">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="host-user" class="col-sm-2 col-form-label">User name</label>
                    <div class="col-sm-4">
                        <input type="text" v-model="host.userName" class="form-control" id="host-user" placeholder="User name">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="host-password" class="col-sm-2 col-form-label">Password</label>
                    <div class="col-sm-4">
                        <input type="password" v-model="host.password" class="form-control" id="host-password" placeholder="">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="host-key-fingerprint" class="col-sm-2 col-form-label">Key Fingerprint</label>
                    <div class="col-sm-4">
                        <input type="text" v-model="host.keyFingerprint" @@blur="host.validateKeyFingerprint()"  class="form-control" id="host-key-fingerprint" placeholder="">
                        <span v-if="host.isKeyFingerprintEmpty" class="error invalid-feedback"><i class="fa fa-skull-crossbones"></i> No security check will be done against the remote host</span>
                    </div>
                    <div class="col-sm-2">
                        <button type="button" class="btn btn-primary" v-on:click="showScanDialog()" :disabled="host.host == ''">Scan</button>
                    </div>
                </div>
                <div class="card-footer">
                    <button type="button" @@click="submit" class="btn btn-info" :disabled="isLoading">Create Host</button>
                    <button type="reset" class="btn btn-default float-right">Cancel</button>
                </div>
                <!-- /.card-footer -->
            </div>
            <!-- /.card-body -->
        </div>
    </form>

    @* Modal for scanning *@
    <div class="modal fade" id="modal-scan-fingerprint" tabindex="-1" role="dialog" aria-labelledby="modal-scan-fingerprint-label" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content" :class="{ 'bg-default' : !isScanError, 'bg-danger' : isScanError }">
                <div class="modal-header">
                    <h5 class="modal-title" id="modal-scan-fingerprint-label">Scan Host Fingerprint : '{{ host.host }}'</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div v-if="this.scanDialogText.length > 0" v-html="scanDialogText"></div>
                    <table v-if="keyFingerprints.length > 0" class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Algorithm</th>
                                <th>Fingerprint</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="kf in keyFingerprints">
                                <td>{{ kf.algorithm }}</td>
                                <td>{{ kf.keyFingerprint }}</td>
                                <td><button type="button" class="btn btn-default" v-on:click="setKeyFingerPrint(kf.keyFingerprint)">Use</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-dark" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</div>